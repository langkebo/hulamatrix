<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>èŠå¤©ç•Œé¢è°ƒè¯•</title>
  <style>
    body {
      font-family: 'PingFang', sans-serif;
      background: radial-gradient(
        circle at top left,
        rgba(255, 209, 255, 0.3) 20%,
        rgba(130, 193, 187, 0.3) 100%
      );
      min-height: 100vh;
      padding: 20px;
      color: #333;
    }

    .debug-container {
      max-width: 1000px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    h1 {
      color: #13987f;
      margin-bottom: 20px;
    }

    .section {
      margin: 20px 0;
      padding: 20px;
      background: #f9f9f9;
      border-radius: 8px;
      border-left: 4px solid #13987f;
    }

    .status {
      padding: 10px;
      margin: 10px 0;
      border-radius: 6px;
    }

    .status.ok {
      background: #f0f9eb;
      color: #52c41a;
    }

    .status.error {
      background: #fef0f0;
      color: #f5222d;
    }

    .status.warning {
      background: #fffbe6;
      color: #faad14;
    }

    code {
      background: #f5f5f5;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: monospace;
      font-size: 14px;
    }

    .debug-button {
      background: #13987f;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      margin: 5px;
    }

    .debug-button:hover {
      background: #0f7d69;
    }

    .debug-result {
      margin-top: 20px;
      padding: 15px;
      background: #f0f9eb;
      border-radius: 6px;
      display: none;
    }

    .route-info {
      font-family: monospace;
      background: #f5f5f5;
      padding: 10px;
      border-radius: 4px;
      margin: 10px 0;
    }

    .component-check {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin: 10px 0;
    }

    .check-item {
      padding: 10px;
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div class="debug-container">
    <h1>ğŸ”§ èŠå¤©ç•Œé¢è°ƒè¯•å·¥å…·</h1>

    <div class="status warning">
      èŠå¤©ç•Œé¢åªæ˜¾ç¤ºæ¸å˜èƒŒæ™¯ï¼Œä½†æ²¡æœ‰å®é™…çš„èŠå¤©ç»„ä»¶
    </div>

    <div class="section">
      <h2>å½“å‰è·¯ç”±ä¿¡æ¯</h2>
      <div class="route-info" id="routeInfo">/</div>
      <p>å½“å‰è·¯ç”±åº”è¯¥åŒ…å« "/message" æ‰èƒ½æ˜¾ç¤ºèŠå¤©ç•Œé¢</p>
    </div>

    <div class="section">
      <h2>ç»„ä»¶æ£€æŸ¥</h2>
      <div class="component-check">
        <div class="check-item">
          <strong>ChatIntegration ç»„ä»¶</strong>
          <div id="chatIntegrationStatus" class="status error">æœªæ‰¾åˆ°</div>
        </div>
        <div class="check-item">
          <strong>ChatBox ç»„ä»¶</strong>
          <div id="chatBoxStatus" class="status error">æœªæ‰¾åˆ°</div>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>CSS å˜é‡æ£€æŸ¥</h2>
      <div class="status">
        <strong>--right-theme-bg-color:</strong>
        <code id="var1">æ£€æŸ¥ä¸­...</code>
      </div>
      <div class="status">
        <strong>--hula-primary:</strong>
        <code id="var2">æ£€æŸ¥ä¸­...</code>
      </div>
      <div class="status">
        <strong>--chat-integration æ ·å¼:</strong>
        <code id="var3">æ£€æŸ¥ä¸­...</code>
      </div>
    </div>

    <div class="section">
      <h2>è°ƒè¯•å·¥å…·</h2>
      <button class="debug-button" onclick="checkComponents()">æ£€æŸ¥ç»„ä»¶</button>
      <button class="debug-button" onclick="applyFix()">åº”ç”¨ä¿®å¤</button>
      <button class="debug-button" onclick="showChatElements()">æ˜¾ç¤ºèŠå¤©å…ƒç´ </button>
      <button class="debug-button" onclick="forceShow()">å¼ºåˆ¶æ˜¾ç¤º</button>
    </div>

    <div class="debug-result" id="debugResult">
      <h3>è°ƒè¯•ç»“æœ</h3>
      <div id="debugOutput"></div>
    </div>

    <div class="section">
      <h2>å¯èƒ½çš„åŸå› </h2>
      <ol>
        <li>è·¯ç”±ä¸æ­£ç¡® - å½“å‰è·¯å¾„ä¸åŒ…å« "/message"</li>
        <li>ç»„ä»¶æœªæ­£ç¡®å¯¼å…¥æˆ–æ³¨å†Œ</li>
        <li>CSS æ ·å¼å†²çªå¯¼è‡´éšè—</li>
        <li>ç»„ä»¶æ¸²æŸ“æ¡ä»¶ä¸æ»¡è¶³</li>
        <li>Vue ç»„ä»¶ç¼–è¯‘é”™è¯¯</li>
      </ol>
    </div>
  </div>

  <script>
    // æ£€æŸ¥è·¯ç”±
    const currentPath = window.location.pathname;
    document.getElementById('routeInfo').textContent = currentPath;

    if (currentPath.includes('/message')) {
      document.getElementById('routeInfo').style.color = '#52c41a';
    } else {
      document.getElementById('routeInfo').style.color = '#f5222d';
    }

    // æ£€æŸ¥CSSå˜é‡
    const rootStyle = getComputedStyle(document.documentElement);

    const checkVars = () => {
      const var1 = rootStyle.getPropertyValue('--right-theme-bg-color') || 'æœªå®šä¹‰';
      const var2 = rootStyle.getPropertyValue('--hula-primary') || 'æœªå®šä¹‰';
      const var3 = rootStyle.getPropertyValue('--chat-integration') || 'æœªå®šä¹‰';

      document.getElementById('var1').textContent = var1;
      document.getElementById('var2').textContent = var2;
      document.getElementById('var3').textContent = var3;

      if (var1 !== 'æœªå®šä¹‰') {
        document.getElementById('var1').parentElement.className = 'status ok';
      }
      if (var2 !== 'æœªå®šä¹‰') {
        document.getElementById('var2').parentElement.className = 'status ok';
      }
      if (var3 !== 'æœªå®šä¹‰') {
        document.getElementById('var3').parentElement.className = 'status ok';
      }
    };

    // ç«‹å³æ£€æŸ¥
    checkVars();

    // æ£€æŸ¥ç»„ä»¶
    function checkComponents() {
      const result = document.getElementById('debugOutput');
      let output = '<h3>ç»„ä»¶æ£€æŸ¥ç»“æœ:</h3>';

      // æ£€æŸ¥ChatIntegration
      const chatIntegrations = document.querySelectorAll('.chat-integration, [class*="chat-integration"]');
      if (chatIntegrations.length > 0) {
        document.getElementById('chatIntegrationStatus').textContent = 'æ‰¾åˆ° ' + chatIntegrations.length + ' ä¸ª';
        document.getElementById('chatIntegrationStatus').className = 'status ok';
        output += '<p>âœ… ChatIntegration ç»„ä»¶å·²æ‰¾åˆ°</p>';
      } else {
        output += '<p>âŒ ChatIntegration ç»„ä»¶æœªæ‰¾åˆ°</p>';
      }

      // æ£€æŸ¥ChatBox
      const chatBoxes = document.querySelectorAll('.chat-box, [class*="chat-box"]');
      if (chatBoxes.length > 0) {
        document.getElementById('chatBoxStatus').textContent = 'æ‰¾åˆ° ' + chatBoxes.length + ' ä¸ª';
        document.getElementById('chatBoxStatus').className = 'status ok';
        output += '<p>âœ… ChatBox ç»„ä»¶å·²æ‰¾åˆ°</p>';
      } else {
        output += '<p>âŒ ChatBox ç»„ä»¶æœªæ‰¾åˆ°</p>';
      }

      result.innerHTML = output;
      document.getElementById('debugResult').style.display = 'block';
    }

    // åº”ç”¨ä¿®å¤
    function applyFix() {
      const style = document.createElement('style');
      style.textContent = `
        /* å¼ºåˆ¶æ˜¾ç¤ºèŠå¤©ç»„ä»¶ */
        .chat-integration, .chat-box, .chat-container {
          display: flex !important;
          flex-direction: column !important;
          height: 100vh !important;
          background: rgba(255, 255, 255, 0.9) !important;
          position: relative !important;
          z-index: 1 !important;
        }

        .chat-integration > *, .chat-box > * {
          display: flex !important;
          flex-direction: column !important;
        }

        /* ç¡®ä¿å³ä¾§é¢æ¿æ˜¾ç¤º */
        .layout-right, main[data-tauri-drag-region] {
          background: rgba(255, 255, 255, 0.9) !important;
        }

        /* è°ƒè¯•è¾¹æ¡† */
        .chat-integration {
          border: 2px dashed #13987f !important;
        }
      `;
      document.head.appendChild(style);

      document.getElementById('debugOutput').innerHTML = '<h3>ä¿®å¤å·²åº”ç”¨</h3><p>å·²æ·»åŠ å¼ºåˆ¶æ˜¾ç¤ºèŠå¤©ç»„ä»¶çš„æ ·å¼</p>';
      document.getElementById('debugResult').style.display = 'block';
    }

    // æ˜¾ç¤ºèŠå¤©å…ƒç´ 
    function showChatElements() {
      const elements = document.querySelectorAll('*');
      let chatElements = [];

      elements.forEach(el => {
        const className = el.className || '';
        const id = el.id || '';

        if (className.includes('chat') || id.includes('chat') ||
            className.includes('Chat') || id.includes('Chat')) {
          chatElements.push(el);
        }
      });

      const output = '<h3>æ‰¾åˆ°çš„èŠå¤©ç›¸å…³å…ƒç´ :</h3>';
      chatElements.forEach((el, index) => {
        output += `<p>${index + 1}. Tag: ${el.tagName}, Class: ${el.className || 'æ— '}, ID: ${el.id || 'æ— '}</p>`;
      });

      document.getElementById('debugOutput').innerHTML = output;
      document.getElementById('debugResult').style.display = 'block';
    }

    // å¼ºåˆ¶æ˜¾ç¤º
    function forceShow() {
      // å¼ºåˆ¶æ˜¾ç¤ºæ‰€æœ‰å¯èƒ½åŒ…å«èŠå¤©çš„å®¹å™¨
      const containers = document.querySelectorAll('main, .flex-1, [class*="flex"], [class*="chat"]');
      containers.forEach(container => {
        if (container.style.display === 'none') {
          container.style.display = 'flex';
        }
        if (container.style.visibility === 'hidden') {
          container.style.visibility = 'visible';
        }
        if (container.style.opacity === '0') {
          container.style.opacity = '1';
        }
      });

      document.getElementById('debugOutput').innerHTML = '<h3>å¼ºåˆ¶æ˜¾ç¤ºå®Œæˆ</h3><p>å·²æ¸…é™¤æ‰€æœ‰éšè—æ ·å¼</p>';
      document.getElementById('debugResult').style.display = 'block';
    }

    // è®¾ç½®CSSå˜é‡
    document.documentElement.style.setProperty('--hula-primary', '#64a29c');
    document.documentElement.style.setProperty('--right-theme-bg-color', 'radial-gradient(circle at top left, rgba(255, 209, 255, 0.3) 20%, rgba(130, 193, 187, 0.3) 100%)');

    // 5ç§’åè‡ªåŠ¨æ£€æŸ¥
    setTimeout(() => {
      checkComponents();
    }, 1000);
  </script>
</body>
</html>