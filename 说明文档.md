# HuLamatrix 项目说明文档

## 1. 项目规划

### 1.1 项目概述
本项目是一个基于 Matrix 协议的通信应用，包含 PC 端（Tauri）和移动端（H5）界面。

### 1.2 当前阶段：架构优化
基于 `UI_STRUCTURE_ANALYSIS.md` 报告进行代码结构优化，重点在于提取共享业务逻辑，减少重复代码。

### 1.3 待办事项
- [x] 提取 E2EE 设备管理共享逻辑 (`useE2EEDevices`)
- [x] 提取 E2EE 设备验证共享逻辑 (`useDeviceVerification`)
- [x] 重构 PC 端设备管理页面
- [x] 重构移动端设备管理页面
- [x] 提取 Spaces 管理共享逻辑 (`useSpaceList`)
- [x] 提取外观设置共享逻辑 (`useAppearanceSettings`)
- [x] 提取通知设置共享逻辑 (`useNotificationSettings`)
- [x] 提取隐私设置共享逻辑 (`usePrivacySettings`)

## 2. 实施方案

### 2.1 共享逻辑提取
在 `src/composables/` 目录下创建 Vue Composables，将 `src/views/` and `src/mobile/views/` 中重复的业务逻辑（如 API 调用、状态管理）抽取出来。

### 2.2 UI 组件重构
更新 UI 组件以使用新的 Composables，确保 UI 行为保持不变，但底层逻辑统一。

## 3. 进度记录

| 日期 | 任务 | 状态 | 结果说明 |
|------|------|------|----------|
| 2026-01-09 | 创建说明文档 | 已完成 | 初始化项目文档 |
| 2026-01-09 | 提取 E2EE 共享逻辑 | 已完成 | 创建 `useE2EEDevices.ts` 和 `useDeviceVerification.ts` |
| 2026-01-09 | 重构 PC 设备管理 | 已完成 | `src/views/e2ee/Devices.vue` 使用共享逻辑 |
| 2026-01-09 | 重构移动端设备管理 | 已完成 | `MobileDeviceList.vue` 和 `MobileDeviceVerifyDialog.vue` 使用共享逻辑 |
| 2026-01-10 | 提取 Spaces 共享逻辑 | 已完成 | 创建 `useSpaceList.ts`，支持 PC 和移动端 Space 列表管理 |
| 2026-01-10 | 提取外观设置逻辑 | 已完成 | 创建 `useAppearanceSettings.ts`，统一主题、字体、布局设置逻辑 |
| 2026-01-10 | 重构外观设置页面 | 已完成 | PC `Appearance.vue` 和移动端 `appearance/index.vue` 完成重构 |
| 2026-01-10 | 提取隐私设置逻辑 | 已完成 | 创建 `usePrivacySettings.ts`，统一屏蔽、举报、列表管理逻辑 |
| 2026-01-10 | 重构隐私设置页面 | 已完成 | PC `Privacy.vue` / `PrivacyManage.vue` 和移动端 `privacy/index.vue` / `privacy/manage.vue` 完成重构 |
